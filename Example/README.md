An example with AL032 shank 1 data used in the manuscript.  

To run the example, please follow the steps below:  
  1. Clone the repo, or download a zip folder
  2. Add the parent folder (.../Neuron_Tracking) to the MATLAB folder with subfolders
  3. Edit paths and required parameters in 'Example_run.m' and run. 
  4. The example script creates some plots; for an overview of drift histograms and estimated false positives from fits to the z-distance distributions, as described in Algorithm box 2 in the paper, run (Neuron_Tracking\Pipeline\Plot\plotDriftHist.m) and (Neuron_Tracking\Pipeline\Plot\fitZ_series.m)

=> 4-shank probes can be tracked together or shank-by-shank by setting the input.shank parameter. If there are multiple peaks in the drift For very 'drifty' recordings, the ideal workflow is to separate the data by shank (e.g. with CatGT), and perform both sorting and tracking independently for each. 

Input required to run the pipleline with your own data:  
- channel_map.npy: standard KS2.5 output
- channel_positions.npy: standard KS2.5 output  
- cluster_KSLabel.tsv: standard KS2.5 output, or any table of unit calls, generated by manual curation, quality metrics, etc. The required format is tab delimeted, two columns, with one header line. The first column must be 0-based cluster indices (matching phy output), second column is calls. Units with call = 'good' will be included in matches.
- ksproc_mean_waveforms.npy: mean waveforms in (nUnit x nChan x nTimepoints), saved as npy. In our examples we used C_Waves to calculate the mean waveforms. For runs with low drift, mean waveforms calculated from uncorrected data may be adequate. 
- metrics.csv: unit metrics; can be generated with ecephys_pipeline or other tool; only the first two columns (cluster ID and firing rate) are required. Note that cluster ID in the metrics table is 0-based; elsewhere in the code the cluster ID is one-based.

